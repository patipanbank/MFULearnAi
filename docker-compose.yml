version: '3.8'

services:
  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
    volumes:
      - ./nginx.conf:/etc/nginx/conf.d/default.conf
    depends_on:
      - frontend
      - backend
    restart: always

  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
    environment:
      - VITE_API_URL=http://mfulearnai.mfu.ac.th
      - VITE_GOOGLE_CLIENT_ID=564967665191-fg9odbpmmhr0ojm04kr5ljm6lku64gce.apps.googleusercontent.com
    restart: always

  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile
    environment:
      - PORT=5000
      - MONGODB_URI=mongodb://localhost:27017/mfu_chatbot
      - JWT_SECRET=cd343ae6f65f6b6e164289b860c89442edc01c7c8ef327d3959e56d542fffbc15065cd1e88e10c8e15754997d252aaedfde3a38a3733f55dcdabfdcf1e27098a
      - GOOGLE_CLIENT_ID=564967665191-fg9odbpmmhr0ojm04kr5ljm6lku64gce.apps.googleusercontent.com
      - ALLOWED_ORIGINS=http://mfulearnai.mfu.ac.th
    restart: always 